(function(t){function e(e){for(var n,a,i=e[0],l=e[1],u=e[2],d=0,p=[];d<i.length;d++)a=i[d],r[a]&&p.push(r[a][0]),r[a]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);c&&c(e);while(p.length)p.shift()();return s.push.apply(s,u||[]),o()}function o(){for(var t,e=0;e<s.length;e++){for(var o=s[e],n=!0,i=1;i<o.length;i++){var l=o[i];0!==r[l]&&(n=!1)}n&&(s.splice(e--,1),t=a(a.s=o[0]))}return t}var n={},r={app:0},s=[];function a(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=t,a.c=n,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(o,n,function(e){return t[e]}.bind(null,n));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var c=l;s.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"034f":function(t,e,o){"use strict";var n=o("64a9"),r=o.n(n);r.a},"0ac1":function(t,e,o){"use strict";var n=o("2110"),r=o.n(n);r.a},2110:function(t,e,o){},"56d7":function(t,e,o){"use strict";o.r(e);o("cadf"),o("551c"),o("f751"),o("097d");var n=o("2b0e"),r=o("8c4f"),s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.user?o("div",{staticClass:"profile"},[o("div",{staticClass:"item"},[o("span",{staticClass:"label"},[t._v("user:")]),o("span",{staticClass:"value"},[t._v(t._s(t.user.Username)+t._s(t.user.Role?" ("+t.user.Role+")":""))])]),o("div",{staticClass:"item"},[o("span",{staticClass:"label"},[t._v("token:")]),o("span",{staticClass:"value"},[t._v(t._s(t.user.Token))])]),o("div",{staticClass:"item"},[o("Button",{staticClass:"logout",attrs:{type:"default"},on:{click:t.logout}},[t._v("登出")])],1)]):t._e()},a=[],i=o("bc3a"),l=o.n(i),u="/api",c={post:function(t,e){return new Promise(function(o,n){l.a.post(u+t,e).then(function(t){return t.data}).then(function(t){0!==t.error?n(t.msg):o(t)}).catch(function(t){return n(t)})})}},d={data:function(){return{user:null}},mounted:function(){this.user=window.user},methods:{logout:function(){c.post("/logout").finally(function(){window.logout_callback&&window.logout_callback()})}}},p=d,m=(o("0ac1"),o("2877")),f=Object(m["a"])(p,s,a,!1,null,"5c6402ba",null),_=f.exports,h=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.data?o("div",[o("Table",{attrs:{stripe:"",columns:t.columns,data:t.data}}),o("Modal",{attrs:{title:"授权端口给用户 "+t.port_modal.user,loading:!0},on:{"on-ok":t.submit_port},model:{value:t.port_modal.show,callback:function(e){t.$set(t.port_modal,"show",e)},expression:"port_modal.show"}},[o("Form",{attrs:{"label-width":80}},[o("FormItem",{attrs:{label:"端口"}},[o("InputNumber",{staticStyle:{width:"300px"},attrs:{step:1,placeholder:"端口号",clearable:""},model:{value:t.port_modal.port,callback:function(e){t.$set(t.port_modal,"port",e)},expression:"port_modal.port"}})],1)],1)],1),o("Modal",{attrs:{title:"授权子域名给用户 "+t.sub_domain_modal.user,loading:!0},on:{"on-ok":t.submit_sub_domain},model:{value:t.sub_domain_modal.show,callback:function(e){t.$set(t.sub_domain_modal,"show",e)},expression:"sub_domain_modal.show"}},[o("Form",{attrs:{"label-width":80}},[o("FormItem",{attrs:{label:"子域名"}},[o("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"子域名",clearable:""},model:{value:t.sub_domain_modal.sub_domain,callback:function(e){t.$set(t.sub_domain_modal,"sub_domain",e)},expression:"sub_domain_modal.sub_domain"}})],1)],1)],1)],1):t._e()},b=[],v=(o("c5f6"),o("04ff"),{data:function(){var t=this;return{port_modal:{show:!1,id:0,user:"",port:1e4},sub_domain_modal:{show:!1,id:0,user:"",sub_domain:""},columns:[{title:"id",key:"UserId"},{title:"username",key:"Username"},{title:"role",key:"Role"},{title:"操作",render:function(e,o){return e("div",[e("Button",{on:{click:function(){t.sub_domain_modal={show:!0,id:o.row.UserId,user:o.row.Username,sub_domain:""}}}},"授权子域名"),e("Button",{on:{click:function(){t.port_modal={show:!0,id:o.row.UserId,user:o.row.Username,port:1e4}}}},"授权端口")])}}],data:null}},created:function(){this.refresh()},methods:{refresh:function(){var t=this;c.post("/users/list").then(function(e){t.data=e.users}).catch(function(t){console.log(t)})},submit_port:function(){var t=this;c.post("/ports/auth",{user_id:this.port_modal.id,port:Number.parseInt(this.port_modal.port)}).then(function(){t.$Notice.success({title:"成功",desc:"授权成功"})}).catch(function(e){t.$Notice.error({title:"错误",desc:e||"授权失败"})}).finally(function(){t.port_modal.show=!1})},submit_sub_domain:function(){var t=this;c.post("/sub_domains/auth",{user_id:this.sub_domain_modal.id,sub_domain:this.sub_domain_modal.sub_domain}).then(function(){t.$Notice.success({title:"成功",desc:"授权成功"})}).catch(function(e){t.$Notice.error({title:"错误",desc:e||"授权失败"})}).finally(function(){t.sub_domain_modal={show:!1}})}}}),w=v,g=Object(m["a"])(w,h,b,!1,null,null,null),y=g.exports,k=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.data?o("div",[o("Table",{attrs:{stripe:"",columns:t.columns,data:t.data}})],1):t._e()},I=[],x={data:function(){return{columns:[{title:"port",key:"Port"},{title:"user_id",key:"UserId"},{title:"username",key:"Username"}],data:null}},created:function(){var t=this;c.post("/ports/list").then(function(e){t.data=e.ports}).catch(function(e){t.$Notice.error({title:"错误",desc:e||"获取端口信息失败"})})}},$=x,O=Object(m["a"])($,k,I,!1,null,null,null),j=O.exports,M=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.data?o("div",[o("Table",{attrs:{stripe:"",columns:t.columns,data:t.data}})],1):t._e()},U=[],C={data:function(){return{columns:[{title:"sub_domain",key:"SubDomain"},{title:"user_id",key:"UserId"},{title:"username",key:"Username"}],data:null}},created:function(){var t=this;c.post("/sub_domains/list").then(function(e){t.data=e.sub_domains}).catch(function(e){t.$Notice.error({title:"错误",desc:e||"获取端口信息失败"})})}},N=C,P=Object(m["a"])(N,M,U,!1,null,null,null),F=P.exports,S=[{path:"/",redirect:"/profile"},{path:"/profile",component:_},{path:"/user",component:y},{path:"/port",component:j},{path:"/sub_domain",component:F}],T=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t.user?o("div",[o("Menu",{attrs:{mode:"horizontal",theme:"light","active-name":t.$route.path},on:{"on-select":t.nav_to}},[o("MenuItem",{attrs:{name:"/profile"}},[o("Icon",{attrs:{type:"ios-people"}}),t._v("\n                个人信息\n            ")],1),"admin"===t.user.Role?o("MenuItem",{attrs:{name:"/user"}},[o("Icon",{attrs:{type:"ios-people"}}),t._v("\n                用户管理\n            ")],1):t._e(),o("MenuItem",{attrs:{name:"/port"}},[o("Icon",{attrs:{type:"ios-paper"}}),t._v("\n                端口管理\n            ")],1),o("MenuItem",{attrs:{name:"/sub_domain"}},[o("Icon",{attrs:{type:"ios-stats"}}),t._v("\n                子域名管理\n            ")],1)],1),o("router-view")],1):t._e(),o("Modal",{attrs:{"footer-hide":"",closable:!1,"mask-closable":!1,title:"登陆"},model:{value:t.login_show,callback:function(e){t.login_show=e},expression:"login_show"}},[o("Form",[o("FormItem",{attrs:{prop:"user"}},[o("Input",{attrs:{type:"text",placeholder:"Username"},model:{value:t.login_form.username,callback:function(e){t.$set(t.login_form,"username",e)},expression:"login_form.username"}},[o("Icon",{attrs:{slot:"prepend",type:"ios-person-outline"},slot:"prepend"})],1)],1),o("FormItem",{attrs:{prop:"password"}},[o("Input",{attrs:{type:"password",placeholder:"Password"},model:{value:t.login_form.password,callback:function(e){t.$set(t.login_form,"password",e)},expression:"login_form.password"}},[o("Icon",{attrs:{slot:"prepend",type:"ios-lock-outline"},slot:"prepend"})],1)],1),o("FormItem",[o("Button",{attrs:{type:"primary"},on:{click:t.login}},[t._v("登陆")])],1)],1)],1)],1)},E=[],B=o("6199"),R=o.n(B),J={data:function(){return{user:null,login_show:!1,login_form:{username:"",password:""}}},created:function(){var t=this;window.logout_callback=function(){t.user=null,window.user=null,t.login_show=!0,t.login_form={username:"",password:""}},this.get_user()},methods:{get_user:function(){var t=this;return c.post("/user/info").then(function(e){t.user=e.user,window.user=e.user,t.login_show=!1}).catch(function(){t.login_show=!0,t.login_form={username:"",password:""}})},nav_to:function(t){this.$router.push(t)},login:function(){var t=this;c.post("/login",{username:this.login_form.username,password:R()(this.login_form.password)}).then(function(){t.get_user()}).catch(function(e){t.$Notice.error({title:"错误",desc:e||"登陆失败"})})}}},z=J,D=(o("034f"),Object(m["a"])(z,T,E,!1,null,null,null)),q=D.exports,A=o("e069"),G=o.n(A);o("dcad");n["default"].config.productionTip=!1,n["default"].use(r["a"]),n["default"].use(G.a),new n["default"]({router:new r["a"]({routes:S}),render:function(t){return t(q)}}).$mount("#app")},"64a9":function(t,e,o){}});
//# sourceMappingURL=app.09902c83.js.map